[
  {
    "id": "4447d55cd1ae879d",
    "text": [
      "## ¬øDe Qu√© Se Trata? ü§î\n",
      "\n",
      "¬°Bienvenidos a *Predicciones de NFL*, una serie donde exploramos lo necesario para hacer predicciones de NFL. En esta primera parte, *El R√©cord*, vamos a analizar c√≥mo el r√©cord de temporada de un equipo afecta las probabilidades de ganar.\n",
      "\n",
      "A medida que avancemos en la serie, desarrollaremos herramientas y eventualmente construiremos modelos predictivos \n",
      "\n",
      "### Aclaraci√≥n\n",
      "\n",
      "Primero, soy relativamente nuevo en el f√∫tbol americano, con solo tres a√±os de experiencia viendo partidos. Aunque todav√≠a tengo mucho por aprender, esta perspectiva fresca me permite enfocarme √∫nicamente en los n√∫meros, sin prejuicios.\n",
      "\n",
      "Segundo, aunque menciono las apuestas, no apoyo jugar con fines de lucro. Apostar una peque√±a cantidad por diversi√≥n o para seguir predicciones est√° bien, pero apostar para ganar dinero puede ser adictivo y da√±ino.\n",
      "\n",
      "### Resumen\n",
      "En este art√≠culo, exploramos si el **r√©cord** de victorias y derrotas de una temporada puede predecir los resultados de los juegos. Al final, construimos un modelo de ML muy simple que predice ganadores con una precisi√≥n del **80%**, cubriendo alrededor de 40 casos por a√±o."
    ]
  },
  {
    "id": "b9e403d655355882",
    "text": [
      "## Los Datos\n",
      "\n",
      "Para esta serie, usaremos los datos jugada por jugada proporcionados por [nflfastR](https://www.nflfastr.com/reference/fast_scraper.html) (Un gran saludo a [nflverse](https://github.com/nflverse)). El conjunto de datos contiene **372 columnas** de datos jugada por jugada, que abarcan desde el **09/12/1999** hasta el **29/11/2024**, con un total de **26 temporadas**, **6,886 juegos** y **1,211,926 jugadas**.\n",
      "\n",
      "A continuaci√≥n, un vistazo r√°pido a los datos."
    ]
  },
  {
    "id": "2584ba5e76993142",
    "text": [
      "\n",
      "Como puedes ver, hay mucha informaci√≥n que va desde *yardas por pase por jugada* hasta *tacleadas con asistencia*.\n",
      "\n",
      "Para esta primera parte de la serie, nos enfocaremos √∫nicamente en c√≥mo los r√©cords impactan los resultados actuales de los juegos. Para simplificar el conjunto de datos, lo reduciremos a la informaci√≥n de Las Vegas y el r√©cord de la temporada actual.\n",
      "\n",
      "A continuaci√≥n, puedes ver una tabla m√°s reducida que utilizaremos:"
    ]
  },
  {
    "id": "e25eca987d006415",
    "text": [
      "## Probabilidades de Las Vegas\n",
      "Cuando se trata de predicciones, la mayor√≠a de los modelos de ML se construyen para competir contra las l√≠neas de Las Vegas. ¬øPero por qu√© luchar contra esto cuando podemos aprovechar la riqueza de informaci√≥n que Las Vegas ofrece? Claro, hay muchas casas de apuestas ofreciendo diferentes probabilidades, y las apuestas p√∫blicas probablemente distorsionen las l√≠neas. Pero para este an√°lisis, la l√≠nea de spread de [Pro-Football-Reference](https://www.pro-football-reference.com/) deber√≠a funcionar perfectamente. Nos proporciona una buena referencia de cu√°n precisa puede ser Las Vegas y prepara el escenario para algunas comparaciones emocionantes.\n",
      "\n",
      "<div style=\"text-align: center;\">\n",
      "  <figure>\n",
      "    <img src=\"article_assets/nfl_vegas_odds.jpg\" alt=\"Scores\" style=\"max-height: 600px;\">\n",
      "    <figcaption>Aaron M. Sprecher (Getty Images)</figcaption>\n",
      "  </figure>\n",
      "</div>"
    ]
  },
  {
    "id": "58957205bc1c8041",
    "text": "Como se muestra en *Fig. 1*, la precisi√≥n de Las Vegas al predecir ganadores utilizando la l√≠nea de spread fue un impresionante **66.3%**."
  },
  {
    "id": "78305780291bd703",
    "text": "Ahora, echemos un vistazo a cu√°n precisa es Las Vegas al proyectar al ganador seg√∫n la l√≠nea de spread. Es importante notar que en esta parte de la serie, no nos estamos enfocando en el margen de puntos en s√≠. Esto significa que no estamos evaluando si el spread fue cubierto; solo estamos prediciendo ganadores sin importar la diferencia de puntos."
  },
  {
    "id": "afe4a7793e92b777",
    "text": [
      "Como era de esperar en *Fig.2*, podemos ver que cuanto mayor es la diferencia proyectada de spread, m√°s precisa es Las Vegas al predecir al ganador. Sin embargo, m√°s del 50% de los juegos tienen una l√≠nea de spread inferior a 4 puntos, y para esos, la precisi√≥n est√° entre 50-60%, lo cual no es muy impresionante.\n",
      "\n",
      "Un dato interesante: en 94 ocasiones donde Las Vegas ofreci√≥ un spread de 15 o m√°s, solo 3 veces el equipo no favorito realmente gan√≥. Esos juegos fueron:\n",
      "\n",
      "- [Bills 27 vs 6 Vikings](https://www.espn.com/nfl/game/_/gameId/401030784/bills-vikings) (23 de septiembre de 2018, Semana 3)\n",
      "- [Dolphins 27 vs 24 Patriots](https://www.espn.com/nfl/game/_/gameId/401127909/dolphins-patriots) (29 de diciembre de 2019, Juego de Comodines)\n",
      "- [Jets 23 vs 20 Rams](https://www.espn.com/nfl/game/_/gameId/401220350) (20 de diciembre de 2020, Semana 16)\n",
      "\n",
      "Otro juego que se destaca, y uno que recuerdo demasiado bien, fue la Semana 14 de la temporada 2023: mi equipo local, los Miami Dolphins, enfrent√≥ a los Tennessee Titans. Miami ten√≠a un buen r√©cord de 9-3, mientras que los Titans estaban luchando con 4-8. Las Vegas le dio a Miami un spread de 14 puntos, pero terminamos perdiendo 28-27. Para colmo, ten√≠a a Tyreek Hill en mi equipo de fantas√≠a, y apenas jug√≥ ese d√≠a üò©.\n",
      "\n",
      "<blockquote class=\"twitter-tweet\" style=\"text-align: center;\"><p lang=\"es\" dir=\"ltr\">La √∫ltima vez que los <a href=\"https://twitter.com/Titans?ref_src=twsrc%5Etfw\">@Titans</a> jugaron contra Miami en MNF, remontaron un d√©ficit de 14 puntos en los √∫ltimos 3 minutos del partido üò≥<br><br>üì∫: <a href=\"https://twitter.com/hashtag/TENvsMIA?src=hash&amp;ref_src=twsrc%5Etfw\">#TENvsMIA</a> ‚Äì Hoy a las 7:30pm ET por ESPN<br>üì±: En vivo en <a href=\"https://twitter.com/hashtag/NFLPlus?src=hash&amp;ref_src=twsrc%5Etfw\">#NFLPlus</a> <a href=\"https://t.co/rBKrieWrzN\">pic.twitter.com/rBKrieWrzN</a></p>&mdash; NFL (@NFL) <a href=\"https://twitter.com/NFL/status/1840777847595549008?ref_src=twsrc%5Etfw\">30 de septiembre de 2024</a></blockquote>\n",
      "\n",
      "<br>"
    ]
  },
  {
    "id": "4a251d7024d4989d",
    "text": [
      "## El R√©cord\n",
      "\n",
      "Vamos a sumergirnos en el objetivo de este art√≠culo y descubrir si el r√©cord de un equipo influye en sus posibilidades de ganar.\n",
      "\n",
      "<div style=\"text-align: center;\">\n",
      "  <figure>\n",
      "    <img src=\"article_assets/nfl_record.webp\" alt=\"Scores\" style=\"max-height: 600px;\">\n",
      "    <figcaption>Chris Graythen (Getty Images)</figcaption>\n",
      "  </figure>\n",
      "</div>"
    ]
  },
  {
    "id": "ec7cbf4b0f45d9b3",
    "text": [
      "Primero, calculemos el **coeficiente de correlaci√≥n de Pearson** de victorias y margen de victoria contra:\n",
      "- Total de Juegos (`record_total_games`)\n",
      "- Juegos Ganados en la Temporada (`season_winning_record`)\n",
      "- Juegos Perdidos en la Temporada (`season_losing_record`)\n",
      "- Porcentaje de Victorias en la Temporada (`season_winning_ratio`)\n",
      "- Juegos Ganados por el Oponente en la Temporada (`opponent_season_winning_record`)\n",
      "- Juegos Perdidos por el Oponente en la Temporada (`opponent_season_losing_record`)\n",
      "- Porcentaje de Victorias del Oponente en la Temporada (`opponent_season_winning_ratio`)\n",
      "- Diferencia en Porcentaje de Victorias (*Porcentaje de Victorias - Porcentaje de Victorias del Oponente*) (`winning_ratio_diff`)\n",
      "- Si el equipo est√° jugando en casa o no (`is_home`)\n",
      "\n",
      "Tambi√©n incluiremos la *L√≠nea de Spread de Las Vegas* para comparaci√≥n."
    ]
  },
  {
    "id": "1b73ffb3082f325b",
    "text": [
      "Como era de esperar, Las Vegas sabe lo que hace: la l√≠nea de spread de Las Vegas est√° mucho m√°s correlacionada con ganar y el margen de victoria que el porcentaje de victorias en juegos. Adem√°s, los porcentajes de victorias son m√°s significativos que el r√©cord en s√≠.\n",
      "\n",
      "¬øPero qu√© pasa con las rachas de victorias? ¬øTienen alg√∫n impacto en la NFL?"
    ]
  },
  {
    "id": "c05f4985deb42c46",
    "text": [
      "Como se muestra en la tabla anterior, el porcentaje de victorias del oponente tiene una correlaci√≥n m√≠nima con las probabilidades de ganar. Sin embargo, las rachas largas, como 12, 13 o 14 juegos, parecen tener una influencia m√°s significativa para determinar al ganador.\n",
      "\n",
      "En otras palabras, tener un r√©cord ganador o perdedor no afecta directamente el resultado de una manera notoria. Pero vamos a profundizar en los datos para ver si podemos descubrir alg√∫n patr√≥n oculto."
    ]
  },
  {
    "id": "5690eebf7e94395f",
    "text": [
      "¬°Ahora s√≠ estamos viendo algo interesante! Como podemos observar, cuando la *diferencia de porcentaje de victorias* es peque√±a, cualquier cosa puede pasar. Pero a medida que nos movemos hacia los extremos‚Äîdonde (>0.25) un gran equipo enfrenta a uno que est√° luchando‚Äîcomenzamos a ver una tendencia clara.\n",
      "\n",
      "Una observaci√≥n interesante es que cuando la `diff=1`, el patr√≥n cambia. Despu√©s de inspeccionar los datos, esto ocurre temprano en la temporada, cuando hay muchos equipos invictos o sin victorias. Entonces, intentemos filtrar los datos para incluir solo juegos despu√©s de la Semana 3."
    ]
  },
  {
    "id": "45953b94ca780db7",
    "text": "Bueno, esto es algo. Vamos a verificar las correlaciones despu√©s de la Semana 3 y cuando la diferencia de porcentaje de victorias sea mayor que 0.25 o menor que -0.25."
  },
  {
    "id": "d383b2ddca01e56f",
    "text": "Ahora nuestros datos se alinean estrechamente con el spread de Las Vegas, lo cual es motivador para intentar construir un modelo de ML simple. Y s√≠, hemos reducido significativamente nuestro conjunto de datos‚Äîde 6,898 juegos a solo 2,254 juegos‚Äîpero bueno, no siempre se puede ganar, ¬øverdad? üòÖ"
  },
  {
    "id": "94ac15017ee21e68",
    "text": [
      "## Aprendizaje Autom√°tico\n",
      "Ahora intentemos crear un modelo de ML simple. Usaremos un [Algoritmo de √Årbol de Decisi√≥n](https://es.wikipedia.org/wiki/Aprendizaje_con_√°rboles_de_decisi√≥n), principalmente porque es sencillo y muy ilustrativo, y tambi√©n porque tenemos un conjunto de datos muy peque√±o, con menos de 10,000 puntos de datos.\n",
      "\n",
      "<div style=\"text-align: center;\">\n",
      "  <figure>\n",
      "    <img src=\"article_assets/nfl_ml.png\" alt=\"ML\" style=\"max-height: 600px;\">\n",
      "    <figcaption>Chat GPT</figcaption>\n",
      "  </figure>\n",
      "</div>"
    ]
  },
  {
    "id": "d90dd151d400f61f",
    "text": [
      "Los √°rboles de decisi√≥n son un tipo de algoritmo supervisado de aprendizaje autom√°tico utilizado tanto para tareas de clasificaci√≥n como de regresi√≥n. Funcionan dividiendo recursivamente los datos en subconjuntos basados en las caracter√≠sticas que proporcionan la separaci√≥n m√°s significativa seg√∫n una m√©trica elegida. Este m√©todo es interpretable, ya que podemos visualizar c√≥mo el √°rbol divide los datos y el proceso de toma de decisiones que sigue. Sin embargo, los √Årboles de Decisi√≥n pueden ser propensos a sobreajustarse, especialmente con conjuntos de datos complejos, por lo que utilizaremos t√©cnicas como limitar la profundidad del √°rbol para garantizar una mejor generalizaci√≥n.\n",
      "\n",
      "Primero, dividiremos los datos. Usaremos datos desde 1999 hasta 2022 para entrenar nuestro √Årbol de Decisi√≥n, y luego probaremos el rendimiento con los datos de 2023 y 2024."
    ]
  },
  {
    "id": "43556735a01c9924",
    "text": [
      "*Fig. 5* muestra el √°rbol de decisi√≥n. Optimizamos los par√°metros utilizando *GridSearchCV*, lo que significa que probamos varias configuraciones de √°rbol para encontrar la que mejor funcion√≥. Como se muestra, el √°rbol tiene 3 niveles de profundidad. Primero verifica si `winning_ratio_diff > -0.029`, luego eval√∫a si `winning_ratio_diff > 0.216`, y finalmente considera si el equipo est√° jugando en casa.\n",
      "\n",
      "Desde 1999 hasta 2022, los equipos locales con un `winning_ratio_diff` de 0.216 jugaron 990 juegos y ganaron 763 de ellos, logrando una impresionante tasa de victorias del 80%.\n",
      "\n",
      "Ahora, probemos c√≥mo habr√≠a funcionado esta regla simple en 2023 y 2024."
    ]
  },
  {
    "id": "9c51e8a2be3e28f1",
    "text": [
      "Como vemos arriba, de 64 casos donde se cumpli√≥ esta condici√≥n, se mantuvo la tasa de victorias del 80%. En 51 de esos casos, el equipo ganador celebr√≥ en casa üéâüéâüéâüéâ.\n",
      "\n",
      "Ahora, pasemos a mostrar la tabla de predicciones."
    ]
  },
  {
    "id": "3cefbfdca5fbdcf6",
    "text": "De hecho, en la Semana 13 de 2024, podr√≠amos haber ganado una apuesta combinada de 7 üòÇ."
  },
  {
    "id": "52372ededc3d415f",
    "text": [
      "## Conclusiones y Cr√©ditos\n",
      "\n",
      "Hemos concluido la primera parte de *Finding NFL Winners*. Logramos un resultado s√≥lido con un √°rbol de decisi√≥n simple que proporciona una tasa de √©xito del 80% en los casos donde se aplic√≥‚Äîalrededor de 35-45 casos por a√±o. En la siguiente parte, profundizaremos en **Puntos**, **Spreads**, y **Totales**.\n",
      "\n",
      "### Agradecimientos:\n",
      "- [OpenAI](https://openai.com/): Sin **ChatGPT**, este art√≠culo no habr√≠a sido posible‚Äîel idioma nativo del autor es el espa√±ol (que apenas habla ahora üòÇ).\n",
      "- [NFLFastR](https://www.nflfastr.com/): Por proporcionar los datos para analizar la NFL.\n",
      "- Mi esposa ‚ù§Ô∏è."
    ]
  }
]